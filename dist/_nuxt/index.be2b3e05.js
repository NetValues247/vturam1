import{_ as F}from"./WelcomeBase.fb4fef78.js";import{v as O,a as T,_ as z}from"./ActiveBoardBase.209f9149.js";import{q as W,r,s as H,S as V,R as J,f as Q,a as u,h as w,b as l,u as e,w as X,t as i,i as C,K as Y,F as Z,B as ee,v as D,j as p,A as te,k as M,l as ae,o as d}from"./entry.bfccc7c4.js";import{f as le}from"./useFormatDigits.ff1e8856.js";import{_ as ne}from"./getAmount.785d5556.js";import{v as se}from"./vend.90322b11.js";import"./ModalBase.f1cd9c23.js";import"./useStrings.92ef0abb.js";const re={class:"rounded-md bg-gray-100 p-2"},oe={class:"flex flex-wrap justify-between mt-4 px-2"},ue={class:"rounded-md bg-white p-2 mt-3"},ie=["onSubmit"],de={class:"mt-3"},ce={for:"subject",class:"block mb-3 font-medium text-lg pl-1"},me=l("option",{value:"null"},"--Select Bouquet Plan--",-1),ve=["value"],pe={class:"mt-3"},be=l("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Mobile Number",-1),_e=["disabled"],fe={key:0,class:"mt-1 text-red-600"},ge={key:1,class:"mt-1 text-red-600"},he={class:"mt-3"},ye=l("label",{for:"sender",class:"block mb-3 font-medium text-lg pl-1"},"Amount",-1),ke={key:2,class:"mt-1 text-red-600"},we={key:0},xe={key:1},Be={class:"text-center p-2 mt-3"},Se=["disabled"],je={key:0,class:"animate-spin h-7 w-7 -mb-2 mr-3 pt-2 border-r-2 border-b-2 border-l-2 border-whtie rounded-full inline-block"},Ne={key:4,class:"text-center p-2 mt-3"},qe=["disabled"],Ee={__name:"index",setup(Ce){const _=W(),f=se();let B=r({}),S=r({}),j=r({}),E=r({}),N=r(0),b=r("");f.getBillerCat();const t=r({mobile_number:"",bouquet:null,recipient:"",network:"",phone:"",type:"giftdata",country:"NG",amount:0,face_amount:0,userId:_.details.track_id,transactionType:"giftingdata-payment",paymentChannel:"Arise_data",charge:.5,plan:null,plan_type:"",Ported_number:!0,currency:_.details.currency});let v=r([]);const x=H();let y=r(""),P=f.services.data.find(s=>s.service_name=="data").service_suffix;V(()=>x.query.network,s=>{t.value.mobile_number="",y.value=null,t.value.phone="",t.value.country="",t.value.amount="",c.value={},t.value.bouquet=null}),J(()=>{if(x.query.network){x.query.network.length>0&&(y.value=x.query.network);{let s=f.services.data.find(n=>n.service_name=="data").percentage.find(n=>n.user_type==_.details.type);if(N.value=s==null?0:s.value,Object.keys(f.dataServices).length>0){let n=y.value+"_"+P,h=f.dataServices[n].ALL;h.length>0&&(v.value=h.filter(m=>m.plan_type!="SME"))}}}});function R(){if(v.value.length>0){let s=v.value.filter(a=>a.id==t.value.plan)[0].network,n=Number(v.value.filter(a=>a.id==t.value.plan)[0].plan_amount),h=v.value.filter(a=>a.id==t.value.plan)[0].plan+" "+v.value.filter(a=>a.id==t.value.plan)[0].month_validate+" "+v.value.filter(a=>a.id==t.value.plan)[0].plan_type;t.value.face_amount=n,t.value.amount=Math.round(n+n*N.value/100);let m=le(t.value.amount);b.value=_.details.currency=="NGN"?`â‚¦${m}`:`$${m}`,t.value.network=s,t.value.plan_type=h,o.value=!1}}let c=r({}),o=r(!1),g=r(5),k=r(!1),q=r();const $=()=>{o.value=!0,q.value=setInterval(U,1e3)},G=()=>{clearInterval(q.value),o.value=!1,g.value=5,k.value=!1};V(g,()=>{g.value<=0&&(clearInterval(q.value),k.value=!0,A())});const U=()=>{g.value--};async function A(){o.value=!0,t.value.recipient=t.value.mobile_number;try{await f.createBill(t.value).then(s=>{o.value=!1,c.value=s,t.value.plan=null,t.value.mobile_number="",b.value="",_.getUserDetails(_.details.track_id)})}catch(s){o.value=!1,c.value=s,t.value.plan=null,t.value.mobile_number="",b.value=""}finally{g.value=5,k.value=!1}}const I=Q(()=>o.value==!0||t.value.mobile_number.length==0||t.value.amount<=0);function L(){B.value=O(t.value.mobile_number),S.value=T(t.value.mobile_number,11),j.value=O(t.value.amount),E.value=T(t.value.amount,11)}return(s,n)=>{const h=F,m=z;return d(),u("div",null,[w(h),l("div",re,[l("div",oe,[w(m,{disabler:e(o),class:"w-1/5 h-32",icon:"mtn.jpg",text:"MTN",link:"dashboard-giftingdata",query:{network:"MTN"}},null,8,["disabler"]),w(m,{disabler:e(o),class:"w-1/5 h-32",icon:"glo.jpg",text:"GLO",link:"dashboard-giftingdata",query:{network:"GLO"}},null,8,["disabler"]),w(m,{disabler:e(o),class:"w-1/5 h-32",icon:"airtel.jpg",text:"AIRTEL",link:"dashboard-giftingdata",query:{network:"AIRTEL"}},null,8,["disabler"]),w(m,{disabler:e(o),class:"w-1/5 h-32",icon:"9mobile.jpg",text:"9MOBILE",link:"dashboard-giftingdata",query:{network:"9MOBILE"}},null,8,["disabler"])]),l("div",ue,[l("form",{onSubmit:X(A,["prevent"])},[l("div",de,[l("label",ce,"Choose the "+i(e(y))+" Plan",1),C(l("select",{class:"p-3 rounded-md w-full ring-0 border border-gray-200","onUpdate:modelValue":n[0]||(n[0]=a=>e(t).plan=a),onChange:R},[me,(d(!0),u(Z,null,ee(e(v),(a,K)=>(d(),u("option",{key:K,value:a.id},i(a.plan)+" "+i(a.month_validate)+" "+i(("getAmount"in s?s.getAmount:e(ne))(Number(a.plan_amount),e(N))),9,ve))),128))],544),[[Y,e(t).plan]])]),l("div",pe,[be,C(l("input",{type:"text",disabled:e(y).length==0,onKeyup:L,"onUpdate:modelValue":n[1]||(n[1]=a=>e(t).mobile_number=a),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,40,_e),[[D,e(t).mobile_number]])]),e(B).status?p("",!0):(d(),u("p",fe,i(e(B).message),1)),e(S).status?p("",!0):(d(),u("p",ge,i(e(S).message),1)),l("div",he,[ye,C(l("input",{type:"text",disabled:!0,"onUpdate:modelValue":n[2]||(n[2]=a=>te(b)?b.value=a:b=a),onKeyup:L,id:"sender",class:"p-3 rounded-md w-full ring-0 border border-gray-200",placeholder:"3000"},null,544),[[D,e(b)]])]),e(j).status?p("",!0):(d(),u("div",ke,i(e(j).message),1)),e(c)?(d(),u("div",{key:3,class:M(["rounded-md p-3 mt-3",{"text-red-600 bg-red-600/[.2]":e(c).status=="error","text-green-600 bg-green-600/[.2]":e(c).status=="success"}])},[e(c).status=="error"?(d(),u("p",we,i(e(c).message)+".",1)):p("",!0),e(c).status=="success"?(d(),u("p",xe,i(e(c).message),1)):p("",!0)],2)):p("",!0),l("div",Be,[l("button",{disabled:e(I),class:M([{"opacity-50":e(I)},"p-3 px-10 bg-[#0f8B8D] w-full lg:w-1/2 text-white rounded-md font-bold text-md hover:bg-[#0a5556]"]),onClick:$},[e(o)?(d(),u("span",je)):p("",!0),ae(" Make "+i(s.$route.query.type)+" Payment",1)],10,Se)]),e(o)?(d(),u("div",Ne,[l("button",{disabled:e(k),onClick:G,class:M([{"opacity-50":e(k)},"p-2 bg-black w-full lg:w-1/2 text-white rounded-md font-bold text-lg"])}," Cancel ("+i(e(g))+") ",11,qe)])):p("",!0)],40,ie)])])])}}};export{Ee as default};
